---

title: neos.makers

keywords: fastai
sidebar: home_sidebar

summary: "Functions that define the workflow from parametric observable --> statistical model."
description: "Functions that define the workflow from parametric observable --> statistical model."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_makers.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This module contains example implementations of functions that are composed such that everything downstream is a function of the parameters of your observable, e.g. the weights of a neural network.</p>
<p>A key idea here is that the functions in this module take in and return functions, such that one can compose them for an end result like:
<code>loss = cls_maker(model_maker(hist_maker)) --&gt; loss(params) = CLs</code>, as we want to compose our workflow such that the end result is explicitly a function of the parameters of the observable.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Histogram-makers:">Histogram makers:<a class="anchor-link" href="#Histogram-makers:"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="hists_from_nn_three_blobs" class="doc_header"><code>hists_from_nn_three_blobs</code><a href="https://github.com/phinate/neos/tree/master/neos/makers.py#L16" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>hists_from_nn_three_blobs</code>(<strong><code>predict</code></strong>, <strong><code>NMC</code></strong>=<em><code>500</code></em>, <strong><code>sig_mean</code></strong>=<em><code>[-1, 1]</code></em>, <strong><code>b1_mean</code></strong>=<em><code>[2, 2]</code></em>, <strong><code>b2_mean</code></strong>=<em><code>[-1, -1]</code></em>, <strong><code>LUMI</code></strong>=<em><code>10</code></em>, <strong><code>sig_scale</code></strong>=<em><code>2</code></em>, <strong><code>bkg_scale</code></strong>=<em><code>10</code></em>)</p>
</blockquote>
<p>Uses the nn decision function <code>predict</code> to form histograms from signal and background
data, all drawn from multivariate normal distributions with different means. Two
background distributions are sampled from, which is meant to mimic the situation in
particle physics where one has a 'nominal' prediction for a nuisance parameter and then
an alternate value (e.g. from varying up/down by one standard deviation), which then
modifies the background pdf. Here, we take that effect to be a shift of the mean of the
distribution. The value for the background histogram is then the mean of the resulting
counts of the two modes, and the uncertainty can be quantified through the count
standard deviation.</p>
<p>Args:
        predict: Decision function for a parameterized observable. Assumed softmax here.</p>
<p>Returns:
        hist_maker: A callable function that takes the parameters of the observable,
        then constructs signal, background, and background uncertainty yields.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example-usage-for-hists_from_nn_three_blobs:">Example usage for <a href="/neos/makers#hists_from_nn_three_blobs"><code>hists_from_nn_three_blobs</code></a>:<a class="anchor-link" href="#Example-usage-for-hists_from_nn_three_blobs:"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">jax.experimental</span> <span class="kn">import</span> <span class="n">stax</span>

<span class="n">init_random_params</span><span class="p">,</span> <span class="n">predict</span> <span class="o">=</span> <span class="n">stax</span><span class="o">.</span><span class="n">serial</span><span class="p">(</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Relu</span><span class="p">,</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="c1"># Two node output -&gt; two bins!</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Softmax</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">hist_maker</span> <span class="o">=</span> <span class="n">hists_from_nn_three_blobs</span><span class="p">(</span><span class="n">predict</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We would then compose <code>hist_maker</code> with other functions that define a model and a way to do statistical inference, but we can still use it standalone if we want:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># initialize network parameters</span>
<span class="n">_</span><span class="p">,</span> <span class="n">network</span> <span class="o">=</span> <span class="n">init_random_params</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">hists_from_network</span> <span class="o">=</span> <span class="n">hist_maker</span><span class="p">()</span>
<span class="n">s</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">b_unc</span> <span class="o">=</span> <span class="n">hists_from_network</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">b_unc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[10.38028255  9.61971745] [45.45590118 54.54409882] [7.6892415 7.6892415]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">129</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bkg&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C9&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sig&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">b_unc</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">b</span> <span class="o">-</span> <span class="n">b_unc</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bkg error&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;nn output&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x140e395d0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-kernel-density-estimation:">Using kernel density estimation:<a class="anchor-link" href="#Using-kernel-density-estimation:"> </a></h2><p>Watch the kernel density estimate mimic a histogram using discrete evaluations of the integral of the cumulative density function:</p>
<p><img src="/neos/assets/kde_bins.giF" alt=""></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="kde_bins_from_nn_three_blobs" class="doc_header"><code>kde_bins_from_nn_three_blobs</code><a href="https://github.com/phinate/neos/tree/master/neos/makers.py#L69" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>kde_bins_from_nn_three_blobs</code>(<strong><code>predict</code></strong>, <strong><code>bins</code></strong>, <strong><code>bandwidth</code></strong>, <strong><code>NMC</code></strong>=<em><code>500</code></em>, <strong><code>sig_mean</code></strong>=<em><code>[-1, 1]</code></em>, <strong><code>b1_mean</code></strong>=<em><code>[2, 2]</code></em>, <strong><code>b2_mean</code></strong>=<em><code>[-1, -1]</code></em>, <strong><code>LUMI</code></strong>=<em><code>10</code></em>, <strong><code>sig_scale</code></strong>=<em><code>2</code></em>, <strong><code>bkg_scale</code></strong>=<em><code>10</code></em>)</p>
</blockquote>
<p>Exactly the same as <a href="/neos/makers#hists_from_nn_three_blobs"><code>hists_from_nn_three_blobs</code></a>, but takes in a regression network, and
forms a kernel density estimate (kde) for the output. The yields are then calculated as
the integral of the kde's cumulative density function between the bin edges, which should
be specified using the argument <code>bins</code>.</p>
<p>Args:
        predict: Decision function for a parameterized observable. When evaluated, the
        output should be one number per event, i.e. a regression network or similar.</p>

<pre><code>    bins: Array of bin edges, e.g. np.linspace(0,1,3) defines a two-bin histogram with
    edges at 0, 0.5, 1.

    bandwidth: Float that controls the 'smoothness' of the kde. It's recommended to keep
    this lower than the bin width to avoid oversmoothing the distribution. Going too low
    will cause things to break, as the gradients of the kde become unstable. 0.1*bin_width
    is a good rule of thumb, but we have yet to properly validate this practically.

</code></pre>
<p>Returns:
        hist_maker: A callable function that takes the parameters of the observable,
        then constructs signal, background, and background uncertainty yields.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example-usage-for-kde_bins_from_nn_three_blobs:">Example usage for <a href="/neos/makers#kde_bins_from_nn_three_blobs"><code>kde_bins_from_nn_three_blobs</code></a>:<a class="anchor-link" href="#Example-usage-for-kde_bins_from_nn_three_blobs:"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">init_random_params</span><span class="p">,</span> <span class="n">predict</span> <span class="o">=</span> <span class="n">stax</span><span class="o">.</span><span class="n">serial</span><span class="p">(</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Relu</span><span class="p">,</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="c1"># One node for regression</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># need to pre-specify binning: use 0-1 range from sigmoid</span>
<span class="c1"># NB: should work with relu etc too, just have to make a binning choice</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">centers</span>   <span class="o">=</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span> <span class="c1"># for plotting</span>

<span class="c1"># pick a bandwidth</span>
<span class="n">bin_width</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">bandwidth</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">bin_width</span>

<span class="n">hist_maker</span> <span class="o">=</span> <span class="n">kde_bins_from_nn_three_blobs</span><span class="p">(</span><span class="n">predict</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">bandwidth</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As before, we can use this stand-alone if desired:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># initialize network parameters</span>
<span class="n">_</span><span class="p">,</span> <span class="n">network</span> <span class="o">=</span> <span class="n">init_random_params</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">hists_from_network</span> <span class="o">=</span> <span class="n">hist_maker</span><span class="p">()</span>
<span class="n">s</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">b_unc</span> <span class="o">=</span> <span class="n">hists_from_network</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">b_unc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[ 6.17462559 12.07716788  1.55236726] [21.62991409 63.26108926 14.43074986] [10.44450875  3.20164352  7.54310471]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">129</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bkg&quot;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">bin_width</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C9&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sig&quot;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">bin_width</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">b_unc</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">b</span> <span class="o">-</span> <span class="n">b_unc</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bkg error&quot;</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">bin_width</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;nn output&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x141b6e3d0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="kde_bins_from_nn_histosys" class="doc_header"><code>kde_bins_from_nn_histosys</code><a href="https://github.com/phinate/neos/tree/master/neos/makers.py#L141" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>kde_bins_from_nn_histosys</code>(<strong><code>predict</code></strong>, <strong><code>bins</code></strong>, <strong><code>bandwidth</code></strong>, <strong><code>NMC</code></strong>=<em><code>500</code></em>, <strong><code>sig_mean</code></strong>=<em><code>[-1, 1]</code></em>, <strong><code>b1_mean</code></strong>=<em><code>[2.5, 2]</code></em>, <strong><code>b_mean</code></strong>=<em><code>[1, -1]</code></em>, <strong><code>b2_mean</code></strong>=<em><code>[-2.5, -1.5]</code></em>, <strong><code>LUMI</code></strong>=<em><code>10</code></em>, <strong><code>sig_scale</code></strong>=<em><code>2</code></em>, <strong><code>bkg_scale</code></strong>=<em><code>10</code></em>)</p>
</blockquote>
<p>Exactly the same as <a href="/neos/makers#hists_from_nn_three_blobs"><code>hists_from_nn_three_blobs</code></a>, but takes in a regression network, and
forms a kernel density estimate (kde) for the output. The yields are then calculated as
the integral of the kde's cumulative density function between the bin edges, which should
be specified using the argument <code>bins</code>.</p>
<p>Args:
        predict: Decision function for a parameterized observable. When evaluated, the
        output should be one number per event, i.e. a regression network or similar.</p>

<pre><code>    bins: Array of bin edges, e.g. np.linspace(0,1,3) defines a two-bin histogram with
    edges at 0, 0.5, 1.

    bandwidth: Float that controls the 'smoothness' of the kde. It's recommended to keep
    this lower than the bin width to avoid oversmoothing the distribution. Going too low
    will cause things to break, as the gradients of the kde become unstable. 0.1*bin_width
    is a good rule of thumb, but we have yet to properly validate this practically.

</code></pre>
<p>Returns:
        hist_maker: A callable function that takes the parameters of the observable,
        then constructs signal, background, and background uncertainty yields.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-makers:">Model makers:<a class="anchor-link" href="#Model-makers:"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="nn_hepdata_like" class="doc_header"><code>nn_hepdata_like</code><a href="https://github.com/phinate/neos/tree/master/neos/makers.py#L217" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>nn_hepdata_like</code>(<strong><code>histogram_maker</code></strong>)</p>
</blockquote>
<p>Returns a function that constructs a typical 'hepdata-like' statistical model
with signal, background, and background uncertainty yields when evaluated at
the parameters of the observable.</p>
<p>Args:
        histogram_maker: A function that, when called, returns a secondary function
        that takes the observable's parameters as argument, and returns yields.</p>
<p>Returns:
        nn_model_maker: A function that returns a Model object (either from
        <code>neos.models</code> or from <code>pyhf</code>) when evaluated at the observable's parameters,
        along with the background-only parameters for use in downstream inference.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example-usage-of-nn_hepdata_like:">Example usage of <a href="/neos/makers#nn_hepdata_like"><code>nn_hepdata_like</code></a>:<a class="anchor-link" href="#Example-usage-of-nn_hepdata_like:"> </a></h3><p>We can compose a histogram maker function with this to create a model:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># uses kde example from previous demo as hist_maker</span>
<span class="n">nn_observable_model</span> <span class="o">=</span> <span class="n">nn_hepdata_like</span><span class="p">(</span><span class="n">hist_maker</span><span class="p">)</span>
<span class="n">model</span><span class="p">,</span> <span class="n">bkg_only_pars</span> <span class="o">=</span> <span class="n">nn_observable_model</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">bkg_only_pars</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;neos.models.Model object at 0x141187d10&gt; [0. 1.]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="nn_histosys" class="doc_header"><code>nn_histosys</code><a href="https://github.com/phinate/neos/tree/master/neos/makers.py#L248" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>nn_histosys</code>(<strong><code>histogram_maker</code></strong>)</p>
</blockquote>
<p>Returns a function that constructs a HEP statistical model using a 'histosys'
uncertainty for the background (nominal background, up and down systematic variations)
when evaluated at the parameters of the observable.</p>
<p>Args:
        histogram_maker: A function that, when called, returns a secondary function
        that takes the observable's parameters as argument, and returns yields.</p>
<p>Returns:
        nn_model_maker: A function that returns a Model object (either from
        <code>neos.models</code> or from <code>pyhf</code>) when evaluated at the observable's parameters,
        along with the background-only parameters for use in downstream inference.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example-usage-of-nn_histosys:">Example usage of <a href="/neos/makers#nn_histosys"><code>nn_histosys</code></a>:<a class="anchor-link" href="#Example-usage-of-nn_histosys:"> </a></h3><p>We can compose a histogram maker function with this to create a model:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">init_random_params</span><span class="p">,</span> <span class="n">predict</span> <span class="o">=</span> <span class="n">stax</span><span class="o">.</span><span class="n">serial</span><span class="p">(</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Relu</span><span class="p">,</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="c1"># One node for regression</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># need to pre-specify binning: use 0-1 range from sigmoid</span>
<span class="c1"># NB: should work with relu etc too, just have to make a binning choice</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">centers</span>   <span class="o">=</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span> <span class="c1"># for plotting</span>

<span class="c1"># pick a bandwidth</span>
<span class="n">bin_width</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">bandwidth</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">bin_width</span>

<span class="n">hist_maker</span> <span class="o">=</span> <span class="n">kde_bins_from_nn_histosys</span><span class="p">(</span><span class="n">predict</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">bandwidth</span><span class="p">)</span>

<span class="n">nn_observable_model</span> <span class="o">=</span> <span class="n">nn_histosys</span><span class="p">(</span><span class="n">hist_maker</span><span class="p">)</span>
<span class="n">model</span><span class="p">,</span> <span class="n">bkg_only_pars</span> <span class="o">=</span> <span class="n">nn_observable_model</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">bkg_only_pars</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;pyhf.pdf.Model object at 0x141010e50&gt; [0. 0.]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

