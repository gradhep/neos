---

title: neos.smooth


keywords: fastai
sidebar: home_sidebar

summary: "Implementation of differentiable substitutes for commonly use operations in high-energy physics."
description: "Implementation of differentiable substitutes for commonly use operations in high-energy physics."
nb_path: "nbs/01_smooth.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_smooth.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="api_boundary.<locals>.reraise_with_filtered_traceback" class="doc_header"><code>api_boundary.<locals>.reraise_with_filtered_traceback</code><a href="https://github.com/gradhep/neos/neos/smooth.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>api_boundary.<locals>.reraise_with_filtered_traceback</code>(<strong><code>events</code></strong>, <strong><code>bins</code></strong>, <strong><code>bandwidth</code></strong>=<em><code>None</code></em>, <strong><code>density</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Args:
        events: (jax array-like) data to filter.</p>

<pre><code>    bins: (jax array-like) intervals to calculate counts.

    bandwidth: (float) value that specifies the width of the individual
    distributions (kernels) whose cdfs are averaged over each bin. Defaults
    to Scott's rule -- the same as the scipy implementation of kde.

    density: (bool) whether or not to normalize the histogram to unit area.
</code></pre>
<p>Returns:
        binned counts, calculated by kde!</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Usage:">Usage:<a class="anchor-link" href="#Usage:"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">neos</span>
<span class="kn">from</span> <span class="nn">neos.smooth</span> <span class="kn">import</span> <span class="n">kde_hist</span>


<span class="k">def</span> <span class="nf">bimodal</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">a_or_b</span><span class="p">,</span><span class="n">random_one</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">random_one</span><span class="o">*</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">random_one</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
    <span class="k">return</span>  <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">a_or_b</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>


<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">a_or_b</span>     <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="p">,)))</span>
<span class="n">random_one</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="p">,)))</span>
<span class="c1"># random_two = jnp.asarray(np.random.normal(size = (N,)))</span>

<span class="n">bins</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>
<span class="n">edge_lo</span>   <span class="o">=</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">edge_hi</span>   <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">centers</span>   <span class="o">=</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
<span class="n">bandwidth</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">bimodal</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">a_or_b</span><span class="p">,</span><span class="n">random_one</span><span class="p">)</span>
<span class="n">kde_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">501</span><span class="p">)</span>

<span class="n">kde_hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">bins</span><span class="p">,</span><span class="n">bandwidth</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray([2.0050249e-01, 7.0200086e-01, 1.5202448e+00, 1.9018129e+01,
             1.8124814e+02, 8.0537366e+02, 1.6403644e+03, 1.7722087e+03,
             1.1718326e+03, 8.6956445e+02, 9.6121869e+02, 9.5239557e+02,
             7.6756525e+02, 4.8393539e+02, 2.3866794e+02, 9.2777985e+01,
             3.2678207e+01, 7.2207165e+00, 8.8439161e-01, 5.7579589e-01],            dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Visualize:">Visualize:<a class="anchor-link" href="#Visualize:"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

<span class="n">c</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">bins</span> <span class="o">=</span> <span class="n">bins</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;histogram&#39;</span><span class="p">);</span>

<span class="k">def</span> <span class="nf">kde</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">jsc</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">loc</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">h</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">summed</span> <span class="o">=</span> <span class="n">kde_hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">bins</span><span class="p">,</span><span class="n">bandwidth</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kde_eval</span><span class="p">,</span><span class="n">kde</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">kde_eval</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="n">bandwidth</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="p">,</span>  <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span><span class="n">summed</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;kde counts&#39;</span><span class="p">)</span>

<span class="c1"># text for fun</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;bandwidth = </span><span class="si">{</span><span class="n">bandwidth</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Background:">Background:<a class="anchor-link" href="#Background:"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A kernel density estimate (KDE) is defined as</p>
<p>{% raw %}
$$KDE(x, h) = \frac{1}{nh} \sum_i K(\frac{x-x_i}{h})$$
{% endraw %}</p>
<p>for some non-negative kernel function $K$. That doesn't mean a massive amount at first glance, at least to me -- what's the intuition here?</p>
<p>A KDE is a way to approximate the probability density implicitly defined by the data $x_i$. By 'implicitly defined', I just mean that the data are clearly distributed in <em>some</em> way, regardless of being able to write down a formula for it or not. The way that the KDE tries to emulate this density is by defining a set of density-like functions -- or kernels -- about each data point, then averaging all of them together. It controls how smooth the overall estimate is by scaling the width of the kernels with a parameter $h$, which is also known as the <strong>bandwidth</strong>.</p>
<p>Here's an example using the standard normal distribution (mean = 0, variance = 1) as the kernel function, where a KDE is made over a set of data sampled from a different normal distribution. The KDE is in blue, and the individual normal distributions for each data point are in grey (scaled down for visibility). A histogram estimate of the data is also shown in orange.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/neos/assets/goodkde.gif" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice how much the bandwidth affects the shape! It turns out to be even more important than the choice of kernel.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can create a 'histogram' from a KDE by simply specifying a set of intervals corresponding to each bin, then finding the area under the curve in each interval. Here's an example for a different set of data drawn from a multi-modal distribution, where can see how close the KDE histogram is to a standard histogram, and also see how this closeness changes with respect to the bandwidth.</p>
<p><img src="/neos/assets/kde_bins.gif" alt="kdehist"></p>

</div>
</div>
</div>
</div>
 

