---

title: neos.smooth


keywords: fastai
sidebar: home_sidebar

summary: "Implementation of differentiable substitutes for commonly use operations in high-energy physics."
description: "Implementation of differentiable substitutes for commonly use operations in high-energy physics."
nb_path: "nbs/01_smooth.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_smooth.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="jit.<locals>.f_jitted" class="doc_header"><code>jit.<locals>.f_jitted</code><a href="https://github.com/phinate/neos/tree/talk/neos/smooth.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>jit.<locals>.f_jitted</code>(<strong><code>events</code></strong>, <strong><code>bins</code></strong>, <strong><code>bandwidth</code></strong>=<em><code>None</code></em>, <strong><code>density</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Args:
        events: (jax array-like) data to filter.</p>

<pre><code>    bins: (jax array-like) intervals to calculate counts.

    bandwidth: (float) value that specifies the width of the individual
    distributions (kernels) whose cdfs are averaged over each bin. Defaults
    to Scott's rule -- the same as the scipy implementation of kde.

    density: (bool) whether or not to normalize the histogram to unit area.
</code></pre>
<p>Returns:
        binned counts, calculated by kde!</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Usage:">Usage:<a class="anchor-link" href="#Usage:"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">neos</span>
<span class="kn">from</span> <span class="nn">neos.smooth</span> <span class="kn">import</span> <span class="n">kde_hist</span>


<span class="k">def</span> <span class="nf">bimodal</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">a_or_b</span><span class="p">,</span><span class="n">random_one</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">random_one</span><span class="o">*</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">random_one</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
    <span class="k">return</span>  <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">a_or_b</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>


<span class="n">N</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">a_or_b</span>     <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="p">,)))</span>
<span class="n">random_one</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="p">,)))</span>
<span class="c1"># random_two = jnp.asarray(np.random.normal(size = (N,)))</span>

<span class="n">bins</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>
<span class="n">edge_lo</span>   <span class="o">=</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">edge_hi</span>   <span class="o">=</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">centers</span>   <span class="o">=</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
<span class="n">bandwidth</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">bimodal</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">a_or_b</span><span class="p">,</span><span class="n">random_one</span><span class="p">)</span>
<span class="n">kde_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">501</span><span class="p">)</span>

<span class="n">kde_hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">bins</span><span class="p">,</span><span class="n">bandwidth</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray([2.2919432e-06, 6.8224673e-03, 7.3981881e-01, 1.5875142e+01,
             1.6476768e+02, 7.4374335e+02, 1.6555591e+03, 1.8281146e+03,
             1.2106138e+03, 8.9572717e+02, 9.2739954e+02, 9.6079938e+02,
             7.5854388e+02, 4.7159320e+02, 2.3169011e+02, 9.2757782e+01,
             3.3618290e+01, 6.1450157e+00, 1.2451103e+00, 5.3824848e-01],            dtype=float32)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Visualize:">Visualize:<a class="anchor-link" href="#Visualize:"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

<span class="n">c</span><span class="p">,</span><span class="n">_</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">bins</span> <span class="o">=</span> <span class="n">bins</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;histogram&#39;</span><span class="p">);</span>

<span class="k">def</span> <span class="nf">kde</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">jsc</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">loc</span><span class="o">=</span><span class="n">data</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">h</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">summed</span> <span class="o">=</span> <span class="n">kde_hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">bins</span><span class="p">,</span><span class="n">bandwidth</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kde_eval</span><span class="p">,</span><span class="n">kde</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">kde_eval</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">h</span><span class="o">=</span><span class="n">bandwidth</span><span class="p">)</span><span class="o">*</span><span class="n">N</span><span class="p">,</span>  <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span><span class="n">summed</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;kde counts&#39;</span><span class="p">)</span>

<span class="c1"># text for fun</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">75</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;bandwidth = </span><span class="si">{</span><span class="n">bandwidth</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Background:">Background:<a class="anchor-link" href="#Background:"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A kernel density estimate (KDE) is defined as</p>
<p>{% raw %}
$$KDE(x, h) = \frac{1}{nh} \sum_i K(\frac{x-x_i}{h})$$
{% endraw %}</p>
<p>for some non-negative kernel function $K$. That doesn't mean a massive amount at first glance, at least to me -- what's the intuition here?</p>
<p>A KDE is a way to approximate the probability density implicitly defined by the data $x_i$. By 'implicitly defined', I just mean that the data are clearly distributed in <em>some</em> way, regardless of being able to write down a formula for it or not. The way that the KDE tries to emulate this density is by defining a set of density-like functions -- or kernels -- about each data point, then averaging all of them together. It controls how smooth the overall estimate is by scaling the width of the kernels with a parameter $h$, which is also known as the <strong>bandwidth</strong>.</p>
<p>Here's an example using the standard normal distribution (mean = 0, variance = 1) as the kernel function, where a KDE is made over a set of data sampled from a different normal distribution. The KDE is in blue, and the individual normal distributions for each data point are in grey (scaled down for visibility). A histogram estimate of the data is also shown in orange.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/neos/assets/goodkde.gif" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice how much the bandwidth affects the shape! It turns out to be even more important than the choice of kernel.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can create a 'histogram' from a KDE by simply specifying a set of intervals corresponding to each bin, then finding the area under the curve in each interval. Here's an example for a different set of data drawn from a multi-modal distribution, where can see how close the KDE histogram is to a standard histogram, and also see how this closeness changes with respect to the bandwidth.</p>
<p><img src="/neos/assets/kde_bins.gif" alt="kdehist"></p>

</div>
</div>
</div>
</div>
 

