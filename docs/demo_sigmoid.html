---

title: The simple 2-bin demo w/ sigmoid activation

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/demo_sigmoid.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/neos/assets/training.gif" alt=""></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">neos.makers</span> <span class="k">as</span> <span class="nn">makers</span>
<span class="kn">import</span> <span class="nn">neos.cls</span> <span class="k">as</span> <span class="nn">cls</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">jax.experimental.stax</span> <span class="k">as</span> <span class="nn">stax</span>
<span class="kn">import</span> <span class="nn">jax.experimental.optimizers</span> <span class="k">as</span> <span class="nn">optimizers</span>
<span class="kn">import</span> <span class="nn">jax.random</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Initialise-network-using-jax.experimental.stax">Initialise network using <code>jax.experimental.stax</code><a class="anchor-link" href="#Initialise-network-using-jax.experimental.stax"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">init_random_params</span><span class="p">,</span> <span class="n">predict</span> <span class="o">=</span> <span class="n">stax</span><span class="o">.</span><span class="n">serial</span><span class="p">(</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Relu</span><span class="p">,</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Relu</span><span class="p">,</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
    <span class="n">stax</span><span class="o">.</span><span class="n">Softmax</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Initialse-tools-from-neos:">Initialse tools from <code>neos</code>:<a class="anchor-link" href="#Initialse-tools-from-neos:"> </a></h3><p>The way we initialise in <code>neos</code> is to define functions that make a statistical model from histograms, which in turn are themselves made from a predictive model, such as a neural network. Here's some detail on the unctions used below:</p>
<ul>
<li><code>hists_from_nn_three_blobs(predict)</code> uses the nn decision function <code>predict</code> defined in the cell above to form histograms from signal and background data, all drawn from multivariate normal distributions with different means. Two background distributions are sampled from, which is meant to mimic the situation in particle physics where one has a 'nominal' prediction for a nuisance parameter and then an alternate value (e.g. from varying up/down by one standard deviation), which then modifies the background pdf. Here, we take that effect to be a shift of the mean of the distribution. The value for the background histogram is then the mean of the resulting counts of the two modes, and the uncertainty can be quantified through the count standard deviation.</li>
<li><code>nn_hepdata_like(hmaker)</code> uses <code>hmaker</code> to construct histograms, then feeds them into the <code>neos.models.hepdata_like</code> function that constructs a pyhf-like model. This can then be used to call things like <code>logpdf</code> and <code>expected_data</code> downstream.</li>
<li><a href="/neos/cls#cls_maker"><code>cls_maker</code></a> takes a model-making function as it's primary argument, which is fed into functions from <code>neos.fit</code> that minimise the <code>logpdf</code> of the model in both a constrained (fixed parameter of interest) and a global way. Moreover, these fits are wrapped in a function that allows us to calculate gradients through the fits using <em>fixed-point differentiation</em>. This allows for the calculation of both the profile likelihood and its gradient, and then the same for $\mathsf{cl_s}$ :)</li>
</ul>
<p>All three of these methods return functions. in particular, <a href="/neos/cls#cls_maker"><code>cls_maker</code></a> returns a function that differentiably calculates $\mathsf{cl_s}$ values, which is our desired objective to minimise.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hmaker</span> <span class="o">=</span> <span class="n">makers</span><span class="o">.</span><span class="n">hists_from_nn_three_blobs</span><span class="p">(</span><span class="n">predict</span><span class="p">)</span>
<span class="n">nnm</span> <span class="o">=</span> <span class="n">makers</span><span class="o">.</span><span class="n">nn_hepdata_like</span><span class="p">(</span><span class="n">hmaker</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">cls_maker</span><span class="p">(</span><span class="n">nnm</span><span class="p">,</span> <span class="n">solver_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">pdf_transform</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Randomly-initialise-nn-weights-and-check-that-we-can-get-the-gradient-of-the-loss-wrt-nn-params">Randomly initialise nn weights and check that we can get the gradient of the loss wrt nn params<a class="anchor-link" href="#Randomly-initialise-nn-weights-and-check-that-we-can-get-the-gradient-of-the-loss-wrt-nn-params"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">network</span> <span class="o">=</span> <span class="n">init_random_params</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">loss</span><span class="p">(</span><span class="n">network</span><span class="p">,</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DeviceArray(0.06006107, dtype=float64)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Define-training-loop!">Define training loop!<a class="anchor-link" href="#Define-training-loop!"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#jit_loss = jax.jit(loss)</span>

<span class="n">opt_init</span><span class="p">,</span> <span class="n">opt_update</span><span class="p">,</span> <span class="n">opt_params</span> <span class="o">=</span> <span class="n">optimizers</span><span class="o">.</span><span class="n">adam</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">)</span>

<span class="c1">#@jax.jit</span>
<span class="k">def</span> <span class="nf">update_and_value</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="n">net</span> <span class="o">=</span> <span class="n">opt_params</span><span class="p">(</span><span class="n">opt_state</span><span class="p">)</span>
    <span class="n">value</span><span class="p">,</span> <span class="n">grad</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">value_and_grad</span><span class="p">(</span><span class="n">loss</span><span class="p">)(</span><span class="n">net</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">opt_update</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">state</span><span class="p">),</span> <span class="n">value</span><span class="p">,</span> <span class="n">net</span>

<span class="k">def</span> <span class="nf">train_network</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">cls_vals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">network</span> <span class="o">=</span> <span class="n">init_random_params</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">opt_init</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>
    <span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="c1"># parameter update function</span>
    <span class="c1">#@jax.jit</span>
    <span class="k">def</span> <span class="nf">update_and_value</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
        <span class="n">net</span> <span class="o">=</span> <span class="n">opt_params</span><span class="p">(</span><span class="n">opt_state</span><span class="p">)</span>
        <span class="n">value</span><span class="p">,</span> <span class="n">grad</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">value_and_grad</span><span class="p">(</span><span class="n">loss</span><span class="p">)(</span><span class="n">net</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">opt_update</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">state</span><span class="p">),</span> <span class="n">value</span><span class="p">,</span> <span class="n">net</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">state</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">network</span> <span class="o">=</span> <span class="n">update_and_value</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">state</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">epoch_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="n">losses</span><span class="p">}</span>
        <span class="k">yield</span> <span class="n">network</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">epoch_time</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Plotting-helper-function-for-awesome-animations-:)">Plotting helper function for awesome animations :)<a class="anchor-link" href="#Plotting-helper-function-for-awesome-animations-:)"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">axarr</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">hm</span><span class="p">,</span> <span class="n">maxN</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span><span class="mi">101</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span><span class="mi">101</span><span class="n">j</span><span class="p">]</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
        <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">predict</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;BrBG&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span>
        <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">predict</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">moveaxis</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">2</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span>
        <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hm</span><span class="o">.</span><span class="n">sig</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">hm</span><span class="o">.</span><span class="n">sig</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;C9&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sig&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hm</span><span class="o">.</span><span class="n">bkg1</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">hm</span><span class="o">.</span><span class="n">bkg1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.17</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bkg1&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hm</span><span class="o">.</span><span class="n">bkg2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">hm</span><span class="o">.</span><span class="n">bkg2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.17</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bkg2&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;slategray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxN</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;epoch&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$cl_s$&quot;</span><span class="p">)</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">axarr</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">s</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">db</span> <span class="o">=</span> <span class="n">hm</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bkg&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C9&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;sig&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">db</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">b</span> <span class="o">-</span> <span class="n">db</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;bkg error&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;frequency&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;nn output&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install-celluloid-for-animations!">Install celluloid for animations!<a class="anchor-link" href="#Install-celluloid-for-animations!"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>python -m pip install celluloid
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Let's-run-it!!">Let's run it!!<a class="anchor-link" href="#Let's-run-it!!"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#slow</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;axes.labelsize&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
        <span class="s2">&quot;axes.linewidth&quot;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span>
        <span class="s2">&quot;xtick.labelsize&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
        <span class="s2">&quot;ytick.labelsize&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
        <span class="s2">&quot;figure.figsize&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">13.</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span>
        <span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span>
        <span class="s2">&quot;xtick.major.size&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;ytick.major.size&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;legend.fontsize&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>

<span class="n">maxN</span> <span class="o">=</span> <span class="mi">50</span> <span class="c1"># make me bigger for better results!</span>

<span class="n">animate</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># animations fail tests...</span>

<span class="k">if</span> <span class="n">animate</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">celluloid</span> <span class="kn">import</span> <span class="n">Camera</span>
    <span class="n">camera</span> <span class="o">=</span> <span class="n">Camera</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="c1"># Training</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">epoch_time</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_network</span><span class="p">(</span><span class="n">maxN</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;epoch </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;CLs = </span><span class="si">{</span><span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">, took </span><span class="si">{</span><span class="n">epoch_time</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">animate</span><span class="p">:</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">axarr</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">nnm</span><span class="o">.</span><span class="n">hm</span><span class="p">,</span> <span class="n">maxN</span><span class="o">=</span><span class="n">maxN</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">camera</span><span class="o">.</span><span class="n">snap</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">camera</span><span class="o">.</span><span class="n">animate</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;animation.gif&quot;</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="s2">&quot;imagemagick&quot;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
            <span class="c1">#HTML(camera.animate().to_html5_video())</span>
<span class="k">if</span> <span class="n">animate</span><span class="p">:</span>
    <span class="n">camera</span><span class="o">.</span><span class="n">animate</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;animation.gif&quot;</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="s2">&quot;imagemagick&quot;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0: CLs = 0.0669196913402792, took 4.881189823150635s
epoch 1: CLs = 0.4841473337607056, took 1.4161441326141357s
epoch 2: CLs = 0.32680532475501645, took 1.4054231643676758s
epoch 3: CLs = 0.1699968874285509, took 1.4557290077209473s
epoch 4: CLs = 0.08482955937838588, took 1.42793607711792s
epoch 5: CLs = 0.04455252530370135, took 1.4426677227020264s
epoch 6: CLs = 0.02509858952860622, took 1.3971951007843018s
epoch 7: CLs = 0.015171918468489975, took 1.3903610706329346s
epoch 8: CLs = 0.009819660207323277, took 1.44907808303833s
epoch 9: CLs = 0.0068158194365592895, took 1.4250729084014893s
epoch 10: CLs = 0.005073459554749471, took 1.418778896331787s
epoch 11: CLs = 0.004014875415832453, took 1.4365489482879639s
epoch 12: CLs = 0.0033303831092827973, took 1.4521620273590088s
epoch 13: CLs = 0.002855594445106968, took 1.4769341945648193s
epoch 14: CLs = 0.002504164311135426, took 1.436406135559082s
epoch 15: CLs = 0.002229384440186166, took 1.4946000576019287s
epoch 16: CLs = 0.0020056710533609134, took 1.53544020652771s
epoch 17: CLs = 0.0018179849800570302, took 1.5617849826812744s
epoch 18: CLs = 0.0016570589973909922, took 1.4964268207550049s
epoch 19: CLs = 0.0015172227216502243, took 1.530569314956665s
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

